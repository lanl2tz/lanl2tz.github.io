<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Repository Directory Structure</title>
    <style>
        body {
            background-color: #1e1e1e;
            color: #c7c7c7;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #ffffff;
        }

        ul {
            list-style-type: none;
            padding-left: 20px;
            margin: 0;
        }

        li {
            position: relative;
            margin: 5px 0;
        }

        .folder>span {
            cursor: pointer;
            user-select: none;
        }

        .folder::before {
            content: "â–¶";
            position: absolute;
            left: -15px;
            color: #c7c7c7;
            transform: rotate(0deg);
            transition: transform 0.2s;
        }

        .folder.expanded::before {
            transform: rotate(90deg);
        }

        .file::before {
            content: "ðŸ“„";
            margin-right: 5px;
        }

        a {
            text-decoration: none;
            color: #9cdcfe;
        }

        a:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>
    <h1>Repository Directory Structure</h1>
    <div id="directory-structure"></div>

    <script>
        const username = 'lanl2tz';
        const repository = 'lanl2tz.github.io';
        const branch = 'main'; // Change to your default branch if not 'main'

        async function fetchDirectory(path = '') {
            const apiUrl = `https://api.github.com/repos/${username}/${repository}/contents/${path}?ref=${branch}`;
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`Error fetching ${path}: ${response.statusText}`);
                }
                const data = await response.json();
                return data;
            } catch (error) {
                console.error(error);
            }
        }

        async function buildTree(parentElement, path = '') {
            const items = await fetchDirectory(path);
            if (!items) return;

            const ul = document.createElement('ul');
            ul.classList.add('hidden'); // Start hidden
            parentElement.appendChild(ul);

            for (const item of items) {
                const li = document.createElement('li');
                const name = item.name;
                const itemPath = item.path;

                if (item.type === 'dir') {
                    li.classList.add('folder');
                    const span = document.createElement('span');
                    span.textContent = name;
                    li.appendChild(span);
                    ul.appendChild(li);

                    // Event listener to toggle visibility
                    span.addEventListener('click', () => {
                        li.classList.toggle('expanded');
                        const childUl = li.querySelector('ul');
                        if (childUl) {
                            childUl.classList.toggle('hidden');
                        }
                    });

                    // Build the subtree
                    await buildTree(li, itemPath);
                } else if (item.type === 'file') {
                    li.classList.add('file');
                    const a = document.createElement('a');
                    a.href = `https://github.com/${username}/${repository}/blob/${branch}/${itemPath}`;
                    a.target = '_blank';
                    a.textContent = name;
                    li.appendChild(a);
                    ul.appendChild(li);
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const rootElement = document.getElementById('directory-structure');
            const rootLi = document.createElement('li');
            rootLi.classList.add('folder');
            const rootSpan = document.createElement('span');
            rootSpan.textContent = repository;
            rootLi.appendChild(rootSpan);
            rootElement.appendChild(rootLi);

            // Event listener for root folder
            rootSpan.addEventListener('click', () => {
                rootLi.classList.toggle('expanded');
                const childUl = rootLi.querySelector('ul');
                if (childUl) {
                    childUl.classList.toggle('hidden');
                }
            });

            buildTree(rootLi);
        });
    </script>
</body>

</html>